
> preflight-mcp@0.7.7 test
> node --experimental-vm-modules node_modules/jest/bin/jest.js tests/integration/cross-pdf.test.ts --testTimeout=60000

  console.error
    [preflight] Loaded config from C:\Users\Administrator\.preflight\config.json

    [0m [90m 74 |[39m         [36mconst[39m content [33m=[39m fs[33m.[39mreadFileSync(configPath[33m,[39m [32m'utf8'[39m)[33m;[39m
     [90m 75 |[39m         cachedConfigFile [33m=[39m [33mJSON[39m[33m.[39mparse(content) [36mas[39m [33mConfigFile[39m[33m;[39m
    [31m[1m>[22m[39m[90m 76 |[39m         console[33m.[39merror([32m`[preflight] Loaded config from ${configPath}`[39m)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 77 |[39m         [36mreturn[39m cachedConfigFile[33m;[39m
     [90m 78 |[39m       }
     [90m 79 |[39m     } [36mcatch[39m (err) {[0m

      at loadConfigFile (src/config.ts:76:17)
      at getConfig (src/config.ts:392:28)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:50:17)

  console.log
    ÈâÅ?RAG Engine initialized

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:71:13)

  console.log
      ChromaDB: https://chromadb.sicko.top:16669

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:72:13)

(node:18084) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
  console.error
    [32m[2026-01-27T14:18:06.521Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "SimpleMem Èç¶?LoCoMo Èç©ÂìÑÂôØÂ®¥Â¨≠ÁòØÊ∂ìÓÖ†ÊÆë F1 ÈçíÂóòÊöüÈéªÊÑ¨Â¥åÈèÑÓàöÓòøÁÅèÊàØÁ¥µ" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:355:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:79:22)

  console.error
    [32m[2026-01-27T14:18:09.345Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 5 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:367:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:79:22)

  console.error
    [32m[2026-01-27T14:18:06.521Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "SimpleMem Èç¶?LoCoMo Èç©ÂìÑÂôØÂ®¥Â¨≠ÁòØÊ∂ìÓÖ†ÊÆë F1 ÈçíÂóòÊöüÈéªÊÑ¨Â¥åÈèÑÓàöÓòøÁÅèÊàØÁ¥µ" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:09.345Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 5 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:26.750Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "SimpleMem Èçú?MAGMA Èç¶„Ñ®ÓÜáËπáÂóôÁ≤çÁºÅÂõ®ÊüüÂØÆÂøéÁ¨ÇÈèàÂ§âÁ≤àÊ∂îÂ†üÊπ∞Áíê„Ñ•Â∞ØÈçíÓÇ¨Á¥µ" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:355:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:38)

  console.error
    [32m[2026-01-27T14:18:26.750Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "SimpleMem Èçú?MAGMA Èç¶„Ñ®ÓÜáËπáÂóôÁ≤çÁºÅÂõ®ÊüüÂØÆÂøéÁ¨ÇÈèàÂ§âÁ≤àÊ∂îÂ†üÊπ∞Áíê„Ñ•Â∞ØÈçíÓÇ¨Á¥µ" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:31.809Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 10 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:367:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [32m[2026-01-27T14:18:31.809Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 10 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [31m[2026-01-27T14:18:46.590Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLM (src/distill/llm-client.ts:101:12)
      at ContextCompleter.verifyChunkAddition (src/rag/context-completer.ts:302:24)
      at ContextCompleter.complete (src/rag/context-completer.ts:161:31)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [33m[2026-01-27T14:18:46.596Z] [WARN] [logger.ts.StructuredLogger.warn] Failed to verify chunk relevance: Error: LLM API error: 429 | {"module":"context-completer"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.warn (src/logging/logger.ts:299:10)
      at Object.warn (src/logging/logger.ts:404:22)
      at ContextCompleter.verifyChunkAddition (src/rag/context-completer.ts:309:14)
      at ContextCompleter.complete (src/rag/context-completer.ts:161:31)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [31m[2026-01-27T14:18:48.750Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLM (src/distill/llm-client.ts:101:12)
      at ContextCompleter.verifyChunkAddition (src/rag/context-completer.ts:302:24)
      at ContextCompleter.complete (src/rag/context-completer.ts:161:31)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [33m[2026-01-27T14:18:48.753Z] [WARN] [logger.ts.StructuredLogger.warn] Failed to verify chunk relevance: Error: LLM API error: 429 | {"module":"context-completer"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.warn (src/logging/logger.ts:299:10)
      at Object.warn (src/logging/logger.ts:404:22)
      at ContextCompleter.verifyChunkAddition (src/rag/context-completer.ts:309:14)
      at ContextCompleter.complete (src/rag/context-completer.ts:161:31)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [31m[2026-01-27T14:18:49.091Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLM (src/distill/llm-client.ts:101:12)
      at ContextCompleter.verifyChunkAddition (src/rag/context-completer.ts:302:24)
      at ContextCompleter.complete (src/rag/context-completer.ts:161:31)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [33m[2026-01-27T14:18:49.094Z] [WARN] [logger.ts.StructuredLogger.warn] Failed to verify chunk relevance: Error: LLM API error: 429 | {"module":"context-completer"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.warn (src/logging/logger.ts:299:10)
      at Object.warn (src/logging/logger.ts:404:22)
      at ContextCompleter.verifyChunkAddition (src/rag/context-completer.ts:309:14)
      at ContextCompleter.complete (src/rag/context-completer.ts:161:31)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [31m[2026-01-27T14:18:49.384Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLM (src/distill/llm-client.ts:101:12)
      at ContextCompleter.verifyChunkAddition (src/rag/context-completer.ts:302:24)
      at ContextCompleter.complete (src/rag/context-completer.ts:161:31)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [33m[2026-01-27T14:18:49.387Z] [WARN] [logger.ts.StructuredLogger.warn] Failed to verify chunk relevance: Error: LLM API error: 429 | {"module":"context-completer"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.warn (src/logging/logger.ts:299:10)
      at Object.warn (src/logging/logger.ts:404:22)
      at ContextCompleter.verifyChunkAddition (src/rag/context-completer.ts:309:14)
      at ContextCompleter.complete (src/rag/context-completer.ts:161:31)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [31m[2026-01-27T14:18:49.730Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLM (src/distill/llm-client.ts:101:12)
      at callLLMWithJSON (src/distill/llm-client.ts:121:22)
      at ContextCompleter.verifyCompleteness (src/rag/context-completer.ts:254:22)
      at ContextCompleter.complete (src/rag/context-completer.ts:131:28)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [31m[2026-01-27T14:18:49.733Z] [ERROR] [logger.ts.StructuredLogger.error] LLM call failed: LLM API error: 429 | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLMWithJSON (src/distill/llm-client.ts:126:12)
      at ContextCompleter.verifyCompleteness (src/rag/context-completer.ts:254:22)
      at ContextCompleter.complete (src/rag/context-completer.ts:131:28)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [32m[2026-01-27T14:18:49.735Z] [INFO] [logger.ts.StructuredLogger.info] Context completion: 1 hops, added 1 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:409:18)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:119:22)

  console.error
    [32m[2026-01-27T14:18:49.745Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "SimpleMem Èê®Âã™Á¨ÅÈóÉËàµÓÜå pipeline ÈçíÂóóÂüÜÈèÑÓàôÁ≤àÊ∂îÂ†¨Á¥µ" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:355:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:173:22)

  console.error
    [31m[2026-01-27T14:18:46.590Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [31m[2026-01-27T14:18:48.750Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [31m[2026-01-27T14:18:49.091Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [31m[2026-01-27T14:18:49.384Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [31m[2026-01-27T14:18:49.730Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [31m[2026-01-27T14:18:49.733Z] [ERROR] [logger.ts.StructuredLogger.error] LLM call failed: LLM API error: 429 | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [33m[2026-01-27T14:18:46.596Z] [WARN] [logger.ts.StructuredLogger.warn] Failed to verify chunk relevance: Error: LLM API error: 429 | {"module":"context-completer"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [33m[2026-01-27T14:18:48.753Z] [WARN] [logger.ts.StructuredLogger.warn] Failed to verify chunk relevance: Error: LLM API error: 429 | {"module":"context-completer"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [33m[2026-01-27T14:18:49.094Z] [WARN] [logger.ts.StructuredLogger.warn] Failed to verify chunk relevance: Error: LLM API error: 429 | {"module":"context-completer"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [33m[2026-01-27T14:18:49.387Z] [WARN] [logger.ts.StructuredLogger.warn] Failed to verify chunk relevance: Error: LLM API error: 429 | {"module":"context-completer"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:49.735Z] [INFO] [logger.ts.StructuredLogger.info] Context completion: 1 hops, added 1 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:49.745Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "SimpleMem Èê®Âã™Á¨ÅÈóÉËàµÓÜå pipeline ÈçíÂóóÂüÜÈèÑÓàôÁ≤àÊ∂îÂ†¨Á¥µ" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:51.559Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 5 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:367:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:173:22)

  console.error
    [31m[2026-01-27T14:18:51.723Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLM (src/distill/llm-client.ts:101:12)
      at callLLMWithJSON (src/distill/llm-client.ts:121:22)
      at ContextCompleter.verifyCompleteness (src/rag/context-completer.ts:254:22)
      at ContextCompleter.complete (src/rag/context-completer.ts:131:28)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:173:22)

  console.error
    [31m[2026-01-27T14:18:51.726Z] [ERROR] [logger.ts.StructuredLogger.error] LLM call failed: LLM API error: 429 | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLMWithJSON (src/distill/llm-client.ts:126:12)
      at ContextCompleter.verifyCompleteness (src/rag/context-completer.ts:254:22)
      at ContextCompleter.complete (src/rag/context-completer.ts:131:28)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:173:22)

  console.log
    ÈâÅ?Source metadata validation:

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:192:15)

  console.log
      Sources with pageIndex: 5/5

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:193:15)

  console.log
      Sources with sectionHeading: 4/5

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:194:15)

  console.log
      Example: [arxiv:2601.02553] A. Detailed System Prompts, page 1

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:198:17)

  console.error
    [32m[2026-01-27T14:18:51.730Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "memory architecture for AI agents" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:355:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:207:38)

  console.error
    [32m[2026-01-27T14:18:54.171Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 10 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:367:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:207:22)

  console.error
    [31m[2026-01-27T14:18:54.405Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLM (src/distill/llm-client.ts:101:12)
      at callLLMWithJSON (src/distill/llm-client.ts:121:22)
      at ContextCompleter.verifyCompleteness (src/rag/context-completer.ts:254:22)
      at ContextCompleter.complete (src/rag/context-completer.ts:131:28)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:207:22)

  console.error
    [31m[2026-01-27T14:18:54.408Z] [ERROR] [logger.ts.StructuredLogger.error] LLM call failed: LLM API error: 429 | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLMWithJSON (src/distill/llm-client.ts:126:12)
      at ContextCompleter.verifyCompleteness (src/rag/context-completer.ts:254:22)
      at ContextCompleter.complete (src/rag/context-completer.ts:131:28)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:207:22)

  console.log
    ÈâÅ?Global query: 2681ms

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:231:15)

  console.log
      Retrieved from 3 bundles, 3 papers

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:232:15)

  console.log
      Total chunks: 10

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:233:15)

  console.error
    [32m[2026-01-27T14:18:54.412Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "SimpleMem Èçú?STACKPLANNER Èê®Âã™Á¥≠ÈçñÊ†´Ê¥∞ÈèçÂõ®ÊπÅÊµ†‚Ç¨Ê∂îÂ†úÁ¨âÈçöÂ≤ãÁ¥µ" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:355:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:239:38)

  console.error
    [31m[2026-01-27T14:18:51.723Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [31m[2026-01-27T14:18:51.726Z] [ERROR] [logger.ts.StructuredLogger.error] LLM call failed: LLM API error: 429 | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [31m[2026-01-27T14:18:54.405Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [31m[2026-01-27T14:18:54.408Z] [ERROR] [logger.ts.StructuredLogger.error] LLM call failed: LLM API error: 429 | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:51.559Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 5 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:51.730Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "memory architecture for AI agents" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:54.171Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 10 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:54.412Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "SimpleMem Èçú?STACKPLANNER Èê®Âã™Á¥≠ÈçñÊ†´Ê¥∞ÈèçÂõ®ÊπÅÊµ†‚Ç¨Ê∂îÂ†úÁ¨âÈçöÂ≤ãÁ¥µ" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:57.704Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 8 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:367:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:239:22)

  console.error
    [31m[2026-01-27T14:18:57.882Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLM (src/distill/llm-client.ts:101:12)
      at callLLMWithJSON (src/distill/llm-client.ts:121:22)
      at ContextCompleter.verifyCompleteness (src/rag/context-completer.ts:254:22)
      at ContextCompleter.complete (src/rag/context-completer.ts:131:28)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:239:22)

  console.error
    [31m[2026-01-27T14:18:57.885Z] [ERROR] [logger.ts.StructuredLogger.error] LLM call failed: LLM API error: 429 | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.error (src/logging/logger.ts:303:10)
      at Object.error (src/logging/logger.ts:408:20)
      at callLLMWithJSON (src/distill/llm-client.ts:126:12)
      at ContextCompleter.verifyCompleteness (src/rag/context-completer.ts:254:22)
      at ContextCompleter.complete (src/rag/context-completer.ts:131:28)
      at RAGEngine.query (src/rag/query.ts:381:34)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:239:22)

  console.log
    ÈâÅ?Performance benchmarks:

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:327:15)

  console.error
    [32m[2026-01-27T14:18:57.895Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "SimpleMem F1 score" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:355:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:331:24)

  console.error
    [32m[2026-01-27T14:19:00.780Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 5 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:367:12)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:331:24)

  console.error
    [31m[2026-01-27T14:18:57.882Z] [ERROR] [logger.ts.StructuredLogger.error] LLM API error: 429 {"error":{"message":"App:**0d2lÈç¶„Ñ¶ƒÅÈç®?longcat-flash-chatai-apiÂß£ÂøìÂûéÈñΩÁÜªÓá¨ÂßπÂÇõÓÇºÈèÅÊãåÁß¥Êù©Âõ¨Ê™∫Èçí?,"type":"rate_limit_error","code":"rate_limit_exceeded"}} | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [31m[2026-01-27T14:18:57.885Z] [ERROR] [logger.ts.StructuredLogger.error] LLM call failed: LLM API error: 429 | {"module":"llm-client"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:57.704Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 8 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:18:57.895Z] [INFO] [logger.ts.StructuredLogger.info] Retrieving context for: "SimpleMem F1 score" (mode: naive) | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:19:00.780Z] [INFO] [logger.ts.StructuredLogger.info] Retrieved 5 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.flushInternal (src/logging/logger.ts:63:12)

  console.error
    [32m[2026-01-27T14:19:37.258Z] [INFO] [logger.ts.StructuredLogger.info] Context completion: 2 hops, added 4 chunks | {"module":"rag"}[0m

    [0m [90m 184 |[39m     
     [90m 185 |[39m     [90m// MCP stdio servers must log to stderr to avoid interfering with protocol[39m
    [31m[1m>[22m[39m[90m 186 |[39m     console[33m.[39merror([32m`${color}${formatted}${reset}`[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 187 |[39m   }
     [90m 188 |[39m
     [90m 189 |[39m   [36mprivate[39m formatLogEntry(entry[33m:[39m [33mLogEntry[39m[33m,[39m format[33m:[39m [32m'json'[39m [33m|[39m [32m'text'[39m)[33m:[39m string {[0m

      at StructuredLogger.writeColoredConsole (src/logging/logger.ts:186:13)
      at StructuredLogger.writeToConsole (src/logging/logger.ts:165:14)
      at StructuredLogger.log (src/logging/logger.ts:275:12)
      at StructuredLogger.info (src/logging/logger.ts:295:10)
      at Object.info (src/logging/logger.ts:397:22)
      at RAGEngine.query (src/rag/query.ts:409:18)
      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:331:24)

FAIL tests/integration/cross-pdf.test.ts (91.115 s)
  Phase 1.5 - Cross-PDF E2E Integration Test
    1. Backward Compatibility - Single Bundle Query
      ËÑ≥ should query single bundle with default crossBundleMode (20324 ms)
    2. Multi-Bundle Query - Specified Mode
      ËÑ≥ should query multiple specified bundles (22990 ms)
      Èà≠?should include pageIndex and sectionHeading in sources (1991 ms)
    3. Global Query - All Bundles
      Èà≠?should query all indexed bundles (2682 ms)
    4. Source Tracing Accuracy
      ËÑ≥ should provide accurate source tracking for cross-bundle queries (3477 ms)
    5. Performance Benchmarks
      ËÑ≥ should meet response time requirements for all query types (39372 ms)

  Èàº?Phase 1.5 - Cross-PDF E2E Integration Test Èà•?1. Backward Compatibility - Single Bundle Query Èà•?should query single bundle with default crossBundleMode

    expect(received).toBeLessThan(expected)

    Expected: < 3000
    Received:   20321

      106 |
      107 |       // Èé¨—ÜÂÖòÁëï‰ΩπÁú∞
    > 108 |       expect(duration).toBeLessThan(3000);
          |                        ^
      109 |
      110 |       console.log(`ÈâÅ?Single bundle query: ${duration}ms`);
      111 |       console.log(`  Sources: ${result.sources.length} chunks from ${TEST_BUNDLES.SimpleMem.paperId}`);

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:108:24)

  Èàº?Phase 1.5 - Cross-PDF E2E Integration Test Èà•?2. Multi-Bundle Query - Specified Mode Èà•?should query multiple specified bundles

    expect(received).toBeLessThan(expected)

    Expected: < 3000
    Received:   22988

      161 |
      162 |       // Èé¨—ÜÂÖòÁëï‰ΩπÁú∞
    > 163 |       expect(duration).toBeLessThan(3000);
          |                        ^
      164 |
      165 |       console.log(`ÈâÅ?Multi-bundle query: ${duration}ms`);
      166 |       console.log(`  Sources from ${bundleIds.size} bundles:`);

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:163:24)

  Èàº?Phase 1.5 - Cross-PDF E2E Integration Test Èà•?4. Source Tracing Accuracy Èà•?should provide accurate source tracking for cross-bundle queries

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      268 |         // Êø°ÂÇõÁÅâÈèà?pageIndexÈîõÂ±ΩÁ∞≤Áíá„É¶Êß∏ÈçöÂ†¢ÊÇäÈê®Âã¨ÓÑúÈèÅÂ≠òÊöü
      269 |         if (source.pageIndex !== undefined) {
    > 270 |           expect(source.pageIndex).toBeGreaterThan(0);
          |                                    ^
      271 |           expect(Number.isInteger(source.pageIndex)).toBe(true);
      272 |         }
      273 |       }

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:270:36)

  Èàº?Phase 1.5 - Cross-PDF E2E Integration Test Èà•?5. Performance Benchmarks Èà•?should meet response time requirements for all query types

    expect(received).toBeLessThan(expected)

    Expected: < 3000
    Received:   39372

      332 |         const duration = Date.now() - startTime;
      333 |
    > 334 |         expect(duration).toBeLessThan(3000);
          |                          ^
      335 |         expect(result.sources.length).toBeGreaterThan(0);
      336 |
      337 |         console.log(`  ${test.name}: ${duration}ms (${result.sources.length} chunks)`);

      at Object.<anonymous> (tests/integration/cross-pdf.test.ts:334:26)

Test Suites: 1 failed, 1 total
Tests:       4 failed, 2 passed, 6 total
Snapshots:   0 total
Time:        91.382 s
Ran all test suites matching tests/integration/cross-pdf.test.ts.
